<!DOCTYPE html>
<html lang="en">
 <head>
  <title>
   Dockerize a Django project
  </title>
  <meta charset="utf-8"/>
  <meta content="width=device-width" name="viewport"/>
  <meta content="" name="description"/>
  <meta content="https://mr-destructive.github.io/techstructive-blog/" property="og:url"/>
  <meta content="website" property="og:type"/>
  <meta content="Techstructive Blog" property="og:title"/>
  <meta content="" property="og:description"/>
  <meta content="https://res.cloudinary.com/techstructive-blog/image/upload/v1646235547/blog-media/a9aafsuwsg1mbt571mmi.png" property="og:image"/>
  <meta content="mr-destructive.github.io" property="twitter:domain"/>
  <meta content="https://mr-destructive.github.io/techstructive-blog/" property="twitter:url"/>
  <meta content="Techstructive Blog" name="twitter:title"/>
  <meta content="" name="twitter:description"/>
  <meta content="https://res.cloudinary.com/techstructive-blog/image/upload/v1646235547/blog-media/a9aafsuwsg1mbt571mmi.png" name="twitter:image"/>
  <link href="../tbicon.png" rel="icon" type="image/png"/>
  <link href="../main.css" rel="stylesheet"/>
  <meta content="markata 0.2.0" name="generator"/>
 </head>
 <body>
  <nav>
   <a href="/techstructive-blog/">
    <h1 id="blog-title">
     Techstructive Blog
    </h1>
   </a>
   <div id="shift">
    This website is now live at
    <a href="https://meetgor.com">
     meetgor.com
    </a>
   </div>
   <ul class="navbar">
    <li>
     <a class="navlink" href="/techstructive-blog">
      Home
     </a>
    </li>
    <li>
     <a class="navlink" href="/techstructive-blog/archive/">
      Archive
     </a>
    </li>
    <li>
     <a class="navlink" href="/techstructive-blog/series/">
      Series
     </a>
    </li>
    <li>
     <a class="navlink" href="/techstructive-blog/projects/">
      Projects
     </a>
    </li>
    <li>
     <a class="navlink" href="/techstructive-blog/tils/">
      Tils
     </a>
    </li>
   </ul>
  </nav>
  <hr/>
  <article class="blog-post h-entry">
   <div id="title-wrapper">
    <a class="u-url" href="/techstructive-blog/dockerize-django-prj/">
     <h1 class="flair" id="title" style="text-align:right;z-index:2;padding-right:.2rem">
      Dockerize a Django project
     </h1>
    </a>
    <a href="/techstructive-blog/django">
     #django
    </a>
    <a href="/techstructive-blog/docker">
     #docker
    </a>
    <p>
     <time class="dt-published post-date" datetime="2022-03-02" style="text-align:right;z-index:2">
      2022-03-02
     </time>
    </p>
    <div class="h-card p-author" rel="author">
     <div class="content">
      <a class="p-name u-url" href="/techstructive-blog/">
       <p>
        <span class="p-given-name">
         Meet
        </span>
        <span class="p-family-name">
         Gor
        </span>
       </p>
      </a>
      <p class="p-note">
       Techstructive Blog
       <a href="https://twitter.com/MeetGor21">
        @MeetGor21
       </a>
      </p>
      <p>
       <a alt="edit post url" href="https://github.com/mr-destructive/techstructive-blog/edit/gh-pages/blog/tils/2022-03-02-Dockerize-Django.md" title="edit this post">
        edit
        <span aria-label="" role="img">
         ✏️
        </span>
       </a>
      </p>
      <p>
      </p>
     </div>
    </div>
   </div>
   <div id="post-body">
    <h2 id="dockerize-a-django-project">
     Dockerize a Django project
    </h2>
    <p>
     We can run our Django projects in a Docker Container by creating a Docker image for our project. It is really easy and intuitive to create a Dockerfile for any given application as it really is a matter of writing commands in a file and basically running it is a isolated environment. To create a Docker image, we first need a Dockerfile. A Dockerfile is simply a Blueprint to create a image in Docker. In this file we specify the instructions/commands/environment variables to create a image for our app to run.
    </p>
    <h3 id="create-a-docker-file">
     Create a Docker File
    </h3>
    <p>
     To create a dockerfile, simply create a file named as
     <code>
      Dockerfile
     </code>
     without any extension(not a .txt file). We need to then add the following code into the file.
    </p>
    <div class="highlight">
     <pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">python:3.9-buster</span>

<span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONUNBUFFERED</span><span class="o">=</span><span class="m">1</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/code</span>

<span class="k">COPY</span><span class="w"> </span>requirements.txt .

<span class="k">RUN</span><span class="w"> </span>pip install -r requirements.txt

<span class="k">COPY</span><span class="w"> </span>. .

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8000</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"python"</span><span class="p">,</span><span class="s2">"manage.py"</span><span class="p">,</span><span class="s2">"runserver"</span><span class="p">,</span><span class="s2">"0.0.0.0:8000"</span><span class="p">]</span>
</code></pre>
    </div>
    <ul>
     <li>
      <p>
       Let's see what are we doing here, first we are pulling a base image of Python in this case it is
       <a href="https://github.com/docker-library/python/blob/a4b368154b7e3c33c76385f1be7a998fcf3123eb/3.9/buster/Dockerfile">
        3.9-buster
       </a>
       , but it can be any of the
       <a href="https://hub.docker.com/_/python">
        Official Python images
       </a>
       from
       <a href="https://hub.docker.com">
        dockerhub
       </a>
       . It is simply a environment for our Django project to run. You can even use linux environments like ubuntu, debian or alpine.
      </p>
     </li>
     <li>
      <p>
       Next we add a
       <code>
        PYTHONUNBUFFERED
       </code>
       as a environment variable and initialize it to
       <code>
        1
       </code>
       , which basically allows to parse python output straight into the terminal without actually buffering first.
      </p>
     </li>
     <li>
      <p>
       We set the
       <code>
        WORKDIR
       </code>
       as the
       <code>
        code
       </code>
       directory, this sets the provided directory as the base to run any command or instructions in the Dockerfile.
      </p>
     </li>
     <li>
      <p>
       We then
       <code>
        COPY
       </code>
       the
       <code>
        requirements.txt
       </code>
       file in the current(
       <code>
        .
       </code>
       ) directory which is
       <code>
        code
       </code>
       as mentioned earlier. We simply want the
       <code>
        requirements.txt
       </code>
       file in the current directory so we can proceed with the next step which is to install the dependencies for the Django project
      </p>
     </li>
     <li>
      <p>
       After copying the
       <code>
        requirements.txt
       </code>
       file, we simply install the packages mentioned int the file with
       <code>
        pip
       </code>
       we use the
       <code>
        RUN
       </code>
       command to execute any shell commands in the environment.
      </p>
     </li>
     <li>
      <p>
       Next step is to
       <code>
        COPY
       </code>
       all the files from the current folder(local machine) into the docker environment image. So, we have the source code files in the Container.
      </p>
     </li>
     <li>
      <p>
       Expose the port
       <code>
        8000
       </code>
       (default) or any other port you would want to run Django in the image. We use the expose command in complement to the
       <code>
        -p
       </code>
       argument when we want to create the container. I have explained the
       <a href="https://mr-destructive.github.io/techstructive-blog/docker-port-forward">
        port-forwarding
       </a>
       concept in the previous TIL.
      </p>
     </li>
     <li>
      <p>
       Finally we can run the server. We need to parse every command as a comma separated string in the list to the
       <code>
        CMD
       </code>
       which the container actually executes the command when the image is build. So, all the commands previously were to build an image for the django project, the
       <code>
        CMD
       </code>
       will actually run the server in a container after building the image of the django project.
      </p>
     </li>
    </ul>
    <h3 id="build-the-image">
     Build the image
    </h3>
    <p>
     Using the Dockerfile, we can create the image for the Django project by a simple command.
    </p>
    <div class="highlight">
     <pre><span></span><code>docker build . -t django-app
</code></pre>
    </div>
    <p>
     Assuming the Dockerfile is in the same folder from which you are running this command.
    </p>
    <p>
     <img alt="Build the django-app image" src="https://res.cloudinary.com/techstructive-blog/image/upload/v1646230907/blog-media/jj04subyvkuvfb5obytu.png"/>
    </p>
    <p>
     <img alt="Build Complete Success" src="https://res.cloudinary.com/techstructive-blog/image/upload/v1646230988/blog-media/ugjoakqgyhiwelqkyaat.png"/>
    </p>
    <h3 id="run-the-image-and-create-a-container">
     Run the Image and Create a Container
    </h3>
    <div class="highlight">
     <pre><span></span><code>docker run -p 8000:8000 django-app
</code></pre>
    </div>
    <p>
     <img alt="Create Container" src="https://res.cloudinary.com/techstructive-blog/image/upload/v1646231023/blog-media/yneuz46burorz4b5vzp4.png"/>
    </p>
    <p>
     You can use any port like
     <code>
      3000
     </code>
     or
     <code>
      4000
     </code>
     on your local system by changing the first port number as
     <code>
      3000:8000
     </code>
     and so on. So, the first port number is the local system's port number and the port number followed by a
     <code>
      :
     </code>
     is the port number for the environment inside the container of the django project. The container port is the same which we have
     <code>
      exposed
     </code>
     while creating the image. You can now go to
     <a href="127.0.0.1:8000">
      127.0.0.1:8000
     </a>
     or your chosen port in your local environment and see the django app running.
    </p>
    <p>
     If you are using a Docker as a Virtual Machine, you need to find the IP-address of that Virtual-Machine(
     <code>
      docker-machine ip
     </code>
     ) and use that instead of
     <code>
      localhost
     </code>
     or
     <code>
      127.0.0.1
     </code>
     .
    </p>
    <h3 id="cleaning-the-container-for-iterations">
     Cleaning the Container for iterations
    </h3>
    <p>
     We need to stop the container to run it again after making a few changes in the app if any. Simply pressing the
     <code>
      CTRL + D
     </code>
     option wont stop the container here. We need to stop the container by executing:
    </p>
    <div class="highlight">
     <pre><span></span><code>docker ps

docker stop &lt;container-id&gt;
</code></pre>
    </div>
    <p>
     This will stop the container. Also if you want to remove the images you built, you can run the command:
    </p>
    <div class="highlight">
     <pre><span></span><code>docker image ls

docker rmi -f &lt;image-id&gt;
</code></pre>
    </div>
    <p>
     So, we now have a image of our Django project, this image can be used by anyone inside a docker environment and thus creating much more easier to test/work on a given project irrespective of the system is being used.
    </p>
   </div>
   <hr/>
   <div id="show">
   </div>
  </article>
  <hr/>
  <footer>
   <ul class="social">
    <li>
     <a href="https://twitter.com/MeetGor21">
      Twitter
      <svg class="svg-icon grey">
       <use xlink:href="../social-icons.svg#twitter">
       </use>
      </svg>
     </a>
    </li>
    <li>
     <a href="https://www.linkedin.com/in/meetgor/">
      LinkedIn
      <svg class="svg-icon grey">
       <use xlink:href="../social-icons.svg#linkedin">
       </use>
      </svg>
     </a>
    </li>
    <li>
     <a href="https://github.com/Mr-Destructive">
      GitHub
      <svg class="svg-icon grey">
       <use xlink:href="../social-icons.svg#github">
       </use>
      </svg>
     </a>
    </li>
    <li>
     <a href="https://dev.to/mr-destructive">
      Dev.to
      <svg class="svg-icon grey">
       <use xlink:href="../social-icons.svg#devto">
       </use>
      </svg>
     </a>
    </li>
    <li>
     <a href="/techstructive-blog/rss.xml">
      RSS
      <svg class="svg-icon orange">
       <use xlink:href="../social-icons.svg#rss">
       </use>
      </svg>
     </a>
    </li>
    <li>
     <a class="u-email" href="mailto:gormeet711@gmail.com">
      Email
     </a>
    </li>
   </ul>
   Techstructive Blog © 2022
  </footer>
 </body>
</html>
